<!-- Views/TranslationTabView.axaml -->
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ae="clr-namespace:AvaloniaEdit;assembly=AvaloniaEdit"
             x:Class="CbetaTranslator.App.Views.TranslationTabView">

	<UserControl.Styles>
		<StyleInclude Source="avares://AvaloniaEdit/Themes/Fluent/AvaloniaEdit.xaml" />

		<Style Selector="ae|TextEditor">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="ItemsControl.assistantList TextBlock">
			<Setter Property="TextWrapping" Value="Wrap"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
		</Style>
	</UserControl.Styles>

	<Grid RowDefinitions="Auto,*">

		<!-- Top toolbar -->
		<Border Grid.Row="0"
				Background="{DynamicResource BarBg}"
				BorderBrush="{DynamicResource BorderBrush}"
				BorderThickness="1"
				Padding="8"
				CornerRadius="6">

			<Grid RowDefinitions="Auto,Auto" RowSpacing="8">

				<!-- Row 1 -->
				<Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
					<StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="6">
						<Button Name="BtnModeHead" Content="Head of File" ToolTip.Tip="Switch to header projection (Ctrl+1)"/>
						<Button Name="BtnModeBody" Content="Body of File" ToolTip.Tip="Switch to body projection (Ctrl+2)"/>
						<Button Name="BtnModeNotes" Content="Notes" ToolTip.Tip="Switch to notes projection (Ctrl+3)"/>
						<Button Name="BtnFindChineseInEn"
								Content="Find Chinese in EN"
								ToolTip.Tip="Find Chinese characters in EN lines and select the EN text (Ctrl+Shift+F). Use this to find the last Chinese characters that prevent your translation from registering as complete."/>
					</StackPanel>

					<TextBlock Grid.Column="1"
							   Name="TxtQuickInfo"
							   Text=""
							   VerticalAlignment="Center"
							   HorizontalAlignment="Left"
							   Opacity="0.8"
							   TextTrimming="CharacterEllipsis"
							   Margin="8,0,0,0"/>

					<StackPanel Grid.Column="2"
								Orientation="Horizontal"
								Spacing="12"
								VerticalAlignment="Center">
						<CheckBox Name="ChkWrap"
								  Content="Wrap"
								  IsChecked="True"
								  ToolTip.Tip="Toggle line wrapping"/>
						<CheckBox Name="ChkAssistantVisible"
								  Content="Assistant"
								  IsChecked="True"
								  ToolTip.Tip="Show or hide the translation assistant pane"/>
					</StackPanel>
				</Grid>

				<!-- Row 2 -->
				<WrapPanel Grid.Row="1"
						   Orientation="Horizontal"
						   ItemSpacing="6"
						   LineSpacing="6"
						   VerticalAlignment="Top">

					<Button Name="BtnUndo" Content="↶" Width="32" ToolTip.Tip="Undo (Ctrl+Z)"/>
					<Button Name="BtnRedo" Content="↷" Width="32" ToolTip.Tip="Redo (Ctrl+Y)"/>

					<Border Width="8"/>

					<TextBlock Text="Copy N:" VerticalAlignment="Center"/>
					<ComboBox Name="CmbChunkSize" Width="72" SelectedIndex="4" ToolTip.Tip="How many blocks max to copy">
						<ComboBoxItem Content="1"/>
						<ComboBoxItem Content="10"/>
						<ComboBoxItem Content="25"/>
						<ComboBoxItem Content="50"/>
						<ComboBoxItem Content="100"/>
						<ComboBoxItem Content="150"/>
					</ComboBox>

					<Button Name="BtnCopyChunkPrompt"
							Content="Copy N + prompt"
							ToolTip.Tip="Copy up to N valid untranslated blocks from the caret (Ctrl+Shift+C)"/>

					<Button Name="BtnPasteByNumber"
							Content="Paste by block #"
							ToolTip.Tip="Paste clipboard blocks and replace EN lines by matching block number (Ctrl+Shift+V)"/>

					<Button Name="BtnNextUntranslated"
							Content="Next untranslated"
							ToolTip.Tip="Jump to next untranslated Chinese block (F8)"/>

					<Border Width="8"/>

					<Button Name="BtnSave" Content="Save XML" ToolTip.Tip="Apply projection edits and save XML (Ctrl+S)"/>
					<Button Name="BtnRevert" Content="Revert from XML" ToolTip.Tip="Reload projection from XML (Ctrl+R)"/>
				</WrapPanel>

			</Grid>
		</Border>

		<!-- Main editor + assistant -->
		<Border Grid.Row="1"
				Margin="0,8,0,0"
				Background="{DynamicResource XmlViewerBg}"
				BorderBrush="{DynamicResource XmlViewerBorder}"
				BorderThickness="1"
				CornerRadius="6">

			<Grid RowDefinitions="Auto,*">
				<Border Grid.Row="0"
						BorderThickness="0,0,0,1"
						BorderBrush="{DynamicResource XmlViewerBorder}"
						Padding="8">
					<TextBlock Name="TxtModeInfo" Text="Translation Editor"/>
				</Border>

				<Grid Grid.Row="1" ColumnDefinitions="*,8,360">
					<!-- Editor side -->
					<Border Grid.Column="0" Padding="0">
						<ae:TextEditor Name="EditorProjection"
									   FontFamily="Consolas"
									   ShowLineNumbers="False"
									   WordWrap="True"
									   HorizontalScrollBarVisibility="Auto"
									   VerticalScrollBarVisibility="Auto"/>
					</Border>

					<!-- Splitter -->
					<GridSplitter Name="AssistantSplitter"
								  Grid.Column="1"
								  Width="8"
								  ResizeDirection="Columns"
								  ResizeBehavior="PreviousAndNext"
								  Background="Transparent"/>

					<!-- Assistant side -->
					<Border Name="AssistantPane"
							Grid.Column="2"
							Padding="8"
							Background="{DynamicResource ControlBg}"
							BorderBrush="{DynamicResource XmlViewerBorder}"
							BorderThickness="1,0,0,0">
						<ScrollViewer HorizontalScrollBarVisibility="Disabled"
									  VerticalScrollBarVisibility="Auto">
							<StackPanel Spacing="10">

								<TextBlock Text="Assistant" FontWeight="Bold"/>

								<Border Padding="8"
										CornerRadius="6"
										BorderThickness="1"
										BorderBrush="{DynamicResource BorderBrush}">
									<StackPanel Spacing="6">
										<TextBlock Text="Approved TM" FontWeight="Bold"/>
										<ItemsControl Name="ApprovedTmItems" Classes="assistantList">
											<ItemsControl.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding}" TextWrapping="Wrap"/>
												</DataTemplate>
											</ItemsControl.ItemTemplate>
										</ItemsControl>
									</StackPanel>
								</Border>

								<Border Padding="8"
										CornerRadius="6"
										BorderThickness="1"
										BorderBrush="{DynamicResource BorderBrush}">
									<StackPanel Spacing="6">
										<TextBlock Text="Reference / AI" FontWeight="Bold"/>
										<ItemsControl Name="ReferenceTmItems" Classes="assistantList">
											<ItemsControl.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding}" TextWrapping="Wrap"/>
												</DataTemplate>
											</ItemsControl.ItemTemplate>
										</ItemsControl>
									</StackPanel>
								</Border>

								<Border Padding="8"
										CornerRadius="6"
										BorderThickness="1"
										BorderBrush="{DynamicResource BorderBrush}">
									<StackPanel Spacing="6">
										<TextBlock Text="Recognized Terms" FontWeight="Bold"/>
										<ItemsControl Name="TermItems" Classes="assistantList">
											<ItemsControl.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding}" TextWrapping="Wrap"/>
												</DataTemplate>
											</ItemsControl.ItemTemplate>
										</ItemsControl>
									</StackPanel>
								</Border>

								<Border Padding="8"
										CornerRadius="6"
										BorderThickness="1"
										BorderBrush="{DynamicResource BorderBrush}">
									<StackPanel Spacing="6">
										<TextBlock Text="Warnings / QA" FontWeight="Bold"/>
										<ItemsControl Name="QaItems" Classes="assistantList">
											<ItemsControl.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding}" TextWrapping="Wrap"/>
												</DataTemplate>
											</ItemsControl.ItemTemplate>
										</ItemsControl>
									</StackPanel>
								</Border>

							</StackPanel>
						</ScrollViewer>
					</Border>
				</Grid>
			</Grid>
		</Border>
	</Grid>
</UserControl>
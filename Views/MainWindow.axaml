<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:CbetaTranslator.App.Views"
        xmlns:models="clr-namespace:CbetaTranslator.App.Models"
        x:Class="CbetaTranslator.App.Views.MainWindow"
        Width="1400" Height="900"
        Background="{DynamicResource AppBg}"
        Title="CBETA Translator">

	<!-- ========================================================= -->
	<!-- RESOURCES (Night + Light + Tokens)                       -->
	<!-- ========================================================= -->

	<Window.Resources>

		<!-- NIGHT -->
		<SolidColorBrush x:Key="Night_AppBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="Night_BarBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="Night_NavBg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Night_TextFg" Color="#FFEAEAEA"/>
		<SolidColorBrush x:Key="Night_TextMutedFg" Color="#FFBDBDBD"/>

		<SolidColorBrush x:Key="Night_ControlBg" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="Night_ControlBgHover" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="Night_ControlBgFocus" Color="#FF2B2B2B"/>

		<SolidColorBrush x:Key="Night_BorderBrush" Color="#FF444444"/>

		<SolidColorBrush x:Key="Night_BtnBg" Color="#FF2A2A2A"/>
		<SolidColorBrush x:Key="Night_BtnBgHover" Color="#FF333333"/>
		<SolidColorBrush x:Key="Night_BtnBgPressed" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="Night_BtnFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="Night_TabBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="Night_TabBgSelected" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="Night_TabFgSelected" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="Night_TooltipBg" Color="#FF0F0F0F"/>
		<SolidColorBrush x:Key="Night_TooltipBorder" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="Night_TooltipFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="Night_SelectionBg" Color="#FF2E5A9E"/>
		<SolidColorBrush x:Key="Night_SelectionFg" Color="#FFFFFFFF"/>

		<!-- LIGHT -->
		<SolidColorBrush x:Key="Light_AppBg" Color="#FFF4F4F4"/>
		<SolidColorBrush x:Key="Light_BarBg" Color="#FFEDEDED"/>
		<SolidColorBrush x:Key="Light_NavBg" Color="#FFE9E9E9"/>

		<SolidColorBrush x:Key="Light_TextFg" Color="#FF1A1A1A"/>
		<SolidColorBrush x:Key="Light_TextMutedFg" Color="#FF5A5A5A"/>

		<SolidColorBrush x:Key="Light_ControlBg" Color="#FFFFFFFF"/>
		<SolidColorBrush x:Key="Light_ControlBgHover" Color="#FFFFFFFF"/>
		<SolidColorBrush x:Key="Light_ControlBgFocus" Color="#FFFFFFFF"/>

		<SolidColorBrush x:Key="Light_BorderBrush" Color="#FFB8B8B8"/>

		<SolidColorBrush x:Key="Light_BtnBg" Color="#FFE7E7E7"/>
		<SolidColorBrush x:Key="Light_BtnBgHover" Color="#FFDCDCDC"/>
		<SolidColorBrush x:Key="Light_BtnBgPressed" Color="#FFD2D2D2"/>
		<SolidColorBrush x:Key="Light_BtnFg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Light_TabBg" Color="#FFEDEDED"/>
		<SolidColorBrush x:Key="Light_TabBgSelected" Color="#FFFFFFFF"/>
		<SolidColorBrush x:Key="Light_TabFgSelected" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="Light_TooltipBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="Light_TooltipBorder" Color="#FF333333"/>
		<SolidColorBrush x:Key="Light_TooltipFg" Color="#FFF2F2F2"/>

		<SolidColorBrush x:Key="Light_SelectionBg" Color="#FFB7D7FF"/>
		<SolidColorBrush x:Key="Light_SelectionFg" Color="#FF000000"/>

		<!-- TOKENS (default = Night) -->
		<SolidColorBrush x:Key="AppBg" Color="#FF111111"/>
		<SolidColorBrush x:Key="BarBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="NavBg" Color="#FF1A1A1A"/>

		<SolidColorBrush x:Key="TextFg" Color="#FFEAEAEA"/>
		<SolidColorBrush x:Key="TextMutedFg" Color="#FFBDBDBD"/>

		<SolidColorBrush x:Key="ControlBg" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="BorderBrush" Color="#FF444444"/>

		<SolidColorBrush x:Key="BtnBg" Color="#FF2A2A2A"/>
		<SolidColorBrush x:Key="BtnBgHover" Color="#FF333333"/>
		<SolidColorBrush x:Key="BtnBgPressed" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="BtnFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="TabBg" Color="#FF1E1E1E"/>
		<SolidColorBrush x:Key="TabBgSelected" Color="#FF2B2B2B"/>
		<SolidColorBrush x:Key="TabFgSelected" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="TooltipBg" Color="#FF0F0F0F"/>
		<SolidColorBrush x:Key="TooltipBorder" Color="#FF3A3A3A"/>
		<SolidColorBrush x:Key="TooltipFg" Color="#FFEAEAEA"/>

		<SolidColorBrush x:Key="SelectionBg" Color="#FF2E5A9E"/>
		<SolidColorBrush x:Key="SelectionFg" Color="#FFFFFFFF"/>

	</Window.Resources>

	<!-- ========================================================= -->
	<!-- GLOBAL STYLES                                             -->
	<!-- ========================================================= -->

	<Window.Styles>

		<!-- Text -->
		<Style Selector="TextBlock">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="TextBlock.muted">
			<Setter Property="Foreground" Value="{DynamicResource TextMutedFg}"/>
		</Style>

		<!-- CheckBox (THIS fixes “Show filenames” being black on Linux) -->
		<Style Selector="CheckBox">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="CheckBox:pointerover">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<!-- Tooltip -->
		<Style Selector="ToolTip">
			<Setter Property="Background" Value="{DynamicResource TooltipBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource TooltipFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource TooltipBorder}"/>
			<Setter Property="BorderThickness" Value="1"/>
		</Style>

		<!-- Buttons (force Foreground on hover/pressed so Linux can’t flip it) -->
		<Style Selector="Button">
			<Setter Property="Background" Value="{DynamicResource BtnBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
		</Style>

		<Style Selector="Button:pointerover">
			<Setter Property="Background" Value="{DynamicResource BtnBgHover}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
		</Style>

		<Style Selector="Button:pressed">
			<Setter Property="Background" Value="{DynamicResource BtnBgPressed}"/>
			<Setter Property="Foreground" Value="{DynamicResource BtnFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
		</Style>

		<!-- TextBox: set control props -->
		<Style Selector="TextBox">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="CaretBrush" Value="{DynamicResource TextFg}"/>
			<Setter Property="SelectionBrush" Value="{DynamicResource SelectionBg}"/>
			<Setter Property="SelectionForegroundBrush" Value="{DynamicResource SelectionFg}"/>
		</Style>

		<!-- TextBox: TEMPLATE OVERRIDE (fixes white focus background on Linux) -->
		<Style Selector="TextBox /template/ Border">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
		</Style>

		<Style Selector="TextBox:pointerover /template/ Border">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
		</Style>

		<Style Selector="TextBox:focus /template/ Border">
			<Setter Property="Background" Value="{DynamicResource ControlBg}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
		</Style>

		<!-- Force text color at the TextBox level (this is the supported way) -->
		<Style Selector="TextBox">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="CaretBrush" Value="{DynamicResource TextFg}"/>
		</Style>

		<!-- If your focused textbox text flips, explicitly restate it -->
		<Style Selector="TextBox:focus">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
			<Setter Property="CaretBrush" Value="{DynamicResource TextFg}"/>
		</Style>

		<!-- Tabs -->
		<Style Selector="TabItem">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="TabItem:pointerover">
			<Setter Property="Foreground" Value="{DynamicResource TextFg}"/>
		</Style>

		<Style Selector="TabItem:selected">
			<Setter Property="Foreground" Value="{DynamicResource TabFgSelected}"/>
		</Style>

		<Style Selector="TabItem /template/ Border">
			<Setter Property="Background" Value="{DynamicResource TabBg}"/>
		</Style>

		<Style Selector="TabItem:pointerover /template/ Border">
			<Setter Property="Background" Value="{DynamicResource BtnBgHover}"/>
		</Style>

		<Style Selector="TabItem:selected /template/ Border">
			<Setter Property="Background" Value="{DynamicResource TabBgSelected}"/>
		</Style>

	</Window.Styles>

	<!-- ========================================================= -->
	<!-- LAYOUT                                                    -->
	<!-- ========================================================= -->

	<Grid RowDefinitions="Auto,*,Auto">

		<!-- Top Bar -->
		<Border Grid.Row="0" Background="{DynamicResource BarBg}" Padding="10">
			<DockPanel LastChildFill="True">

				<StackPanel Orientation="Horizontal" Spacing="8" DockPanel.Dock="Left">
					<Button Name="BtnToggleNav" Width="40" Height="32" Content="☰"/>
					<Button Name="BtnOpenRoot" Width="140" Height="32" Content="Open Root"/>
					<Button Name="BtnLicenses" Width="110" Height="32" Content="ⓘ Licenses"/>
					<TextBlock Name="TxtRoot" Margin="10,0,0,0" Classes="muted"/>
				</StackPanel>

				<TextBlock Name="TxtCurrentFile"
						   DockPanel.Dock="Right"
						   Classes="muted"/>
			</DockPanel>
		</Border>

		<!-- Main -->
		<Grid Grid.Row="1" ColumnDefinitions="Auto,Auto,*">

			<Border Name="NavPanel"
					Background="{DynamicResource NavBg}"
					Width="320">

				<!-- ✅ Reduced vertical crowding -->
				<Grid Margin="8"
					  RowDefinitions="Auto,Auto,Auto,*"
					  RowSpacing="8">

					<TextBlock Text="Files" FontWeight="Bold" Classes="muted"/>

					<TextBox Name="NavSearch"
							 Grid.Row="1"
							 Watermark="Search (filename or title)…"/>

					<!-- ✅ Two checkboxes on one row, with a spacer -->
					<StackPanel Grid.Row="2"
								Orientation="Horizontal"
								Spacing="10">
						<CheckBox Name="ChkShowFilenames"
								  Content="Show filenames"/>
						<Border Width="6"/>
						<CheckBox Name="ChkZenOnly"
								  Content="Zen texts"/>
					</StackPanel>

					<ListBox Name="FilesList"
							 Grid.Row="3"
							 Background="{DynamicResource ControlBg}"
							 BorderBrush="{DynamicResource BorderBrush}"
							 BorderThickness="1">

						<ListBox.ItemTemplate>
							<DataTemplate x:DataType="models:FileNavItem">
								<Border CornerRadius="6"
										Padding="6"
										Margin="4"
										Background="{Binding Status, Converter={x:Static views:NavStatusToBrushConverter.Instance}}">
									<TextBlock Text="{Binding DisplayShort}"
											   ToolTip.Tip="{Binding Tooltip}"
											   TextWrapping="NoWrap"/>
								</Border>
							</DataTemplate>
						</ListBox.ItemTemplate>

					</ListBox>

				</Grid>
			</Border>

			<Border Grid.Column="2" Margin="8">
				<TabControl Name="MainTabs">
					<TabItem Header="Readable">
						<views:ReadableTabView Name="ReadableView"/>
					</TabItem>
					<TabItem Header="Translate XML">
						<views:TranslationTabView Name="TranslationView"/>
					</TabItem>
					<TabItem Header="Search">
						<views:SearchTabView Name="SearchView"/>
					</TabItem>
					<TabItem Header="Git">
						<views:GitTabView Name="GitView"/>
					</TabItem>
				</TabControl>
			</Border>

		</Grid>

		<!-- Status -->
		<Border Grid.Row="2"
				Background="{DynamicResource BarBg}"
				Padding="8">
			<TextBlock Name="TxtStatus" Classes="muted"/>
		</Border>

	</Grid>

</Window>
